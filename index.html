<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Spendio Master Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        @font-face { font-family: 'WaloneBold'; src: url('fonts/Z06-Walone Bold.ttf') format('truetype'); font-display: swap; }
        :root { --bg: #0b0d14; --sidebar: #131622; --card: #191c29; --border: #262a3b; --primary: #00ffa3; --text: #ffffff; --text-dim: #8f9bb3; --fs-base: 14px; --fs-sub: 13px; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; overflow: hidden; height: 100vh; }
        
        /* AUTH OVERLAY */
        #authOverlay { position: fixed; inset: 0; background: var(--bg); display: flex; align-items: center; justify-content: center; z-index: 9999; }
        .login-card { background: var(--card); border: 1px solid var(--border); padding: 40px; border-radius: 24px; width: 380px; text-align: center; }
        input { width: 100%; padding: 14px; background: #0c0e12; border: 1px solid var(--border); color: #fff; border-radius: 12px; margin-bottom: 15px; outline: none; }
        .btn-ui { width: 100%; height: 50px; background: var(--primary); border: none; border-radius: 15px; font-weight: 800; cursor: pointer; font-family: 'WaloneBold'; }

        /* APP LAYOUT */
        #appContainer { display: none; width: 100%; height: 100%; }
        .sidebar { width: 260px; background: var(--sidebar); border-right: 1px solid var(--border); display: flex; flex-direction: column; height: 100vh; }
        .main-content { flex: 1; overflow-y: auto; position: relative; background: radial-gradient(circle at top right, #1a1f33, #0b0d14); }
        .logout-btn { margin-top: auto; padding: 20px; color: #ff3d71; cursor: pointer; display: flex; align-items: center; gap: 10px; font-weight: 600; }
    </style>
</head>
<body>

    <div id="authOverlay">
        <div class="login-card">
            <h2 style="margin-bottom:20px; font-family:'WaloneBold';">အကောင့်ဝင်ရန်</h2>
            <input type="email" id="lEmail" placeholder="Email">
            <input type="password" id="lPass" placeholder="Password">
            <button class="btn-ui" onclick="handleLogin()">Login</button>
            <p id="err" style="color:#ff3d71; font-size:12px; margin-top:10px; display:none;">မှားယွင်းနေပါသည်။</p>
        </div>
    </div>

    <div id="appContainer" style="display:flex;">
        <div class="sidebar">
            <div style="padding:30px; font-size:24px; color:var(--primary); font-family:'WaloneBold';">Spendio</div>
            <div style="padding:15px 25px; color:#fff; border-left:3px solid var(--primary); background:rgba(0,255,163,0.05);">ခြုံသုံးသပ်ချက်</div>
            <div class="logout-btn" onclick="handleLogout()"><i class="fa-solid fa-power-off"></i> Logout</div>
        </div>
        <div class="main-content">
            <div style="padding:30px;">
                <h2 style="font-family:'WaloneBold'; margin-bottom:20px;">Dashboard Pro</h2>
                <p>အောင်မြင်စွာ Login ဝင်ရောက်ပြီးပါပြီ။</p>
                </div>
        </div>
    </div>

    <script>
        const SUPABASE_URL = 'https://tfarfiporzdpcjrqxxxj.supabase.co', SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRmYXJmaXBvcnpkcGNqcnF4eHhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg4OTk1NTMsImV4cCI6MjA4NDQ3NTU1M30.Kww0TMDxeCtybOtnAWakXiEIA0hZSKpB19K_cLrB7qo';
        const sc = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        async function checkUser() {
            const {data:{user}} = await sc.auth.getUser();
            if(user) {
                document.getElementById('authOverlay').style.display = 'none';
                document.getElementById('appContainer').style.display = 'flex';
            } else {
                document.getElementById('authOverlay').style.display = 'flex';
                document.getElementById('appContainer').style.display = 'none';
            }
        }

        async function handleLogin() {
            const {error} = await sc.auth.signInWithPassword({ email: document.getElementById('lEmail').value, password: document.getElementById('lPass').value });
            if(error) document.getElementById('err').style.display = 'block'; else checkUser();
        }

        async function handleLogout() {
            await sc.auth.signOut();
            /* GitHub Pages Safe Reload */
            location.href = location.origin + location.pathname;
        }

        window.onload = checkUser;
    </script>
</body>
</html>
